!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(e):t.Dialog=e()}(this,function(require){"function"==typeof require&&require("common/ui/Loading");var t=window.addEventListener?'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><path d="M116.152,99.999l36.482-36.486c2.881-2.881,2.881-7.54,0-10.42 l-5.215-5.215c-2.871-2.881-7.539-2.881-10.42,0l-36.484,36.484L64.031,47.877c-2.881-2.881-7.549-2.881-10.43,0l-5.205,5.215 c-2.881,2.881-2.881,7.54,0,10.42l36.482,36.486l-36.482,36.482c-2.881,2.881-2.881,7.549,0,10.43l5.205,5.215 c2.881,2.871,7.549,2.871,10.43,0l36.484-36.488L137,152.126c2.881,2.871,7.549,2.871,10.42,0l5.215-5.215 c2.881-2.881,2.881-7.549,0-10.43L116.152,99.999z"/></svg>':"",e="WebkitAppearance"in document.documentElement.style||"undefined"!=typeof document.webkitHidden;$.dialog=function(t){return new i(t)};var i=function(i){var n={title:"",content:"",width:"auto",buttons:[],onShow:$.noop,onHide:$.noop,onRemove:$.noop},o=$.extend({},n,i||{}),a={};this.el=a,this.width=o.width,this.callback={show:o.onShow,hide:o.onHide,remove:o.onRemove},a.container=window.addEventListener?$('<dialog class="ui-dialog-container"></dialog>'):$('<div class="ui-dialog-container"></div>'),history.pushState&&a.container.get(0).addEventListener(e?"webkitAnimationEnd":"animationend",function(t){"dialog"==t.target.tagName.toLowerCase()&&this.classList.remove("ui-dialog-animation")}),a.dialog=$('<div class="ui-dialog"></div>').css("width",o.width).attr({tabindex:"-1",role:"dialog"}),a.title=$('<div class="ui-dialog-title" role="heading"></div>').html(o.title);var s=("id_"+Math.random()).replace("0.","");a.close=$('<a href="javascript:" class="ui-dialog-close ESC"></a>').attr({role:"button","aria-label":"关闭",id:s,"data-target":s}).html(t).click($.proxy(function(t){t.preventDefault();var e=document.activeElement,i=e.getAttribute("data-target"),n=i&&document.getElementById(i);window.isKeyEvent&&n&&e!=a.close[0]&&document.querySelector('a[data-target="'+i+'"],input[data-target="'+i+'"]')&&n.clientWidth>0||this[this.closeMode]()},this));var l=o.content;$.isFunction(l)&&(l=l()),l.size?this.closeMode="hide":this.closeMode="remove",a.body=$('<div class="ui-dialog-body"></div>')[l.size?"append":"html"](l),a.footer=$('<div class="ui-dialog-footer"></div>'),this.button(o.buttons),a.container.append(a.dialog.append(a.close).append(a.title).append(a.body).append(a.footer)),document.querySelector||a.container.append('<i class="ui-dialog-after"></i>');var r=$(".ui-dialog-container");return r.length?r.eq(0).before(a.container.css({zIndex:1*r.eq(0).css("z-index")+1})):(o.container||$(document.body)).append(a.container),this.display=!1,o.content&&this.show(),this};return i.prototype.button=function(t){var e=this.el,i=this;return e.footer.empty(),$.each(t,function(t,n){n=n||{};var o=t?n.type||"":n.type||"primary",a=t?n.value||"取消":n.value||"确定",s=n.events||{click:function(){i[i.closeMode]()}};$.isFunction(s)&&(s={click:s});var l="ui-button";o&&(l=l+" "+l+"-"+o),n["for"]?e["button"+t]=$('<label for="'+n["for"]+'" class="'+l+'" role="button">'+a+"</label>"):e["button"+t]=$('<a href="javascript:" class="'+l+'" role="button">'+a+"</a>"),$.each(s,function(n,o){e["button"+t].bind(n,{dialog:i},o),e["button"+t].on("focus",function(){$(this).css("outline",window.isKeyEvent?"":"none")})}),e.footer.append(e["button"+t])}),i},i.prototype.loading=function(){if(!$().loading)return window.console&&window.console.error("need Loading.js"),e;var t=this.el,e=this;return t&&(t.container.attr("class",["ui-dialog-container","ui-dialog-loading"].join(" ")),t.body.loading(),e.show()),e},i.prototype.unloading=function(t){if(!$().unloading)return window.console&&window.console.error("need Loading.js"),i;var e=this.el,i=this;return e&&(e.container.removeClass("ui-dialog-loading"),e.body.unloading(t)),i},i.prototype.open=function(t,e){var i=this.el,n=this,o={title:"",buttons:[]},a=$.extend({},o,e||{});return i&&t&&(i.container.attr("class",["ui-dialog-container"].join(" ")),i.title.html(a.title),i.body.html(t),n.button(a.buttons).show()),n},i.prototype.alert=function(t,e){var i=this.el,n=this,o={title:"",type:"remind",buttons:[{}]},a=$.extend({},o,e||{});return a.buttons[0].type||"remind"==a.type||(a.buttons[0].type=a.type),i&&t&&(i.container.attr("class",["ui-dialog-container","ui-dialog-alert"].join(" ")),i.dialog.width("auto").attr({role:"alertdialog"}),i.title.html(a.title),0==/<[\w\W]+>/.test(t)&&(t="<p>"+t+"</p>"),i.body.html('<div class="ui-dialog-'+a.type+' ui-dialog-alert">'+t+"</div>"),this.button(a.buttons).show(),i.button0&&i.button0.focus()),n},i.prototype.confirm=function(t,e){var i=this.el,n=this,o={title:"",type:"warning",buttons:[{type:"warning"},{}]},a=$.extend({},o,e||{});return a.buttons.length&&!a.buttons[0].type&&(a.buttons[0].type="warning"),i&&t&&(i.container.attr("class",["ui-dialog-container","ui-dialog-confirm"].join(" ")),i.dialog.width("auto"),i.title.html(a.title),0==/<[\w\W]+>/.test(t)&&(t="<p>"+t+"</p>"),i.body.html('<div class="ui-dialog-'+a.type+' ui-dialog-confirm">'+t+"</div>"),this.button(a.buttons).show(),i.button0&&i.button0.focus()),n},i.prototype.ajax=function(t,e){var i=this,n={dataType:"JSON",timeout:3e4,error:function(t,e){var n="";n="timeout"==e?"<p>主要是由于请求时间过长，数据没能成功加载，这一般是由于网速过慢导致，您可以稍后重试！</p>":"parsererror"==e?"<p>原因是请求的数据含有不规范的内容。一般出现这样的问题是开发人员没有考虑周全，欢迎向我们反馈此问题！</p>":"<p>一般是网络出现了异常，如断网；或是网络临时阻塞，您可以稍后重试！如依然反复出现此问题，欢迎向我们反馈！</p>",i.alert("<h6>尊敬的用户，很抱歉您刚才的操作没有成功！</h6>"+n,{type:"warning"}).unloading()}},o=$.extend({},n,t||{});if(!o.url)return this;var a={title:"",content:function(t){return"string"==typeof t?t:"看见我说明没使用'options.content'做JSON解析"},buttons:[]},s=$.extend({},a,e||{}),l=(new Date).getTime(),r=o.success;return o.success=function(t){i.open(s.content(t),s),(new Date).getTime()-l<100?i.unloading(0):i.unloading(),$.isFunction(r)&&r.apply(this,arguments)},i.loading(),$.ajax(o),i},i.prototype.scroll=function(){var t=!1;if($(".ui-dialog-container").each(function(){"block"==$(this).css("display")&&(t=!0)}),t){var e=17;1!=this.display&&"number"==typeof window.innerWidth&&(e=window.innerWidth-document.documentElement.clientWidth),document.documentElement.style.overflow="hidden",1!=this.display&&$(document.body).css("border-right",e+"px solid transparent")}else document.documentElement.style.overflow="",$(document.body).css("border-right","");return this},i.prototype.tabindex=function(){var t=this.el.dialog,e=this.lastActiveElement;if(1==this.display){var i=document.activeElement;t[0]!==i&&(this.lastActiveElement=i),t&&t.focus()}else e&&"body"!=e.tagName.toLowerCase()&&(e.focus(),e.blur(),this.lastActiveElement=null);return t},i.prototype.show=function(){var t=this.el&&this.el.container;return t&&(t.css("display","block"),1!=this.display&&t.addClass("ui-dialog-animation"),this.scroll(),this.display=!0,this.tabindex(),$.isFunction(this.callback.show)&&this.callback.show.call(this,t)),this},i.prototype.hide=function(){var t=this.el.container;return t&&(t.hide(),this.scroll(),this.display=!1,this.tabindex(),$.isFunction(this.callback.hide)&&this.callback.hide.call(this,t)),this},i.prototype.remove=function(){var t=this.el&&this.el.container;return t&&(t.remove(),this.scroll(),this.display=!1,this.tabindex(),$.isFunction(this.callback.remove)&&this.callback.remove.call(this,t)),this},i});